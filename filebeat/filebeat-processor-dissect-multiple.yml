filebeat.inputs:
  - type: filestream
    paths:
      - /tmp/example-text.log
      - /tmp/example-counter.log

processors:
  - if:
      regexp:
        message: "ERROR|WARN|INFO|DEBUG"
    then:
      - add_fields:
          target: ""
          fields:
            message_type: loggen
      - dissect:
          tokenizer: "%{module} %{date} %{time} %{level} %{message}"
          field: "message"
          target_prefix: "dissect.loggen"
          ignore_failure: true
  - if:
      regexp:
        message: "^\\d+"
    then:
      - add_fields:
          target: ""
          fields:
            message_type: counter
      - dissect:
          tokenizer: "%{counter|integer}"
          field: "message"
          target_prefix: "dissect.counter"
          ignore_failure: true

output.elasticsearch:
  hosts:
    - "localhost:9200"
